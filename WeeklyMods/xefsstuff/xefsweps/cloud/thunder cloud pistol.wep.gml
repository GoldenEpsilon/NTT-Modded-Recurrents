#define init
global.sprThunderCloudPistol_0 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAG1BMVEUAAAAAAAAiERA0IR5HLy1OYHRnRD+QpLSYrr93Wv6TAAAAAXRSTlMAQObYZgAAAE5JREFUeNq1jDEOwDAIA2tw6P9/XENK1AwZe4ORTxbXERRbHbcYWMoNUQBYDjRBD7xGheauJKZRibBMBkSN0CpPKvFd9X9CMCfN/JD5Pw8AKQFW6lpVtgAAAABJRU5ErkJggg==", -1, 4);
global.sprThunderCloudPistol_1 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAG1BMVEUAAAAAAAAiERA0IR5HLy1OYHRnRD+QpLSYrr93Wv6TAAAAAXRSTlMAQObYZgAAAE9JREFUeNq1jEEOgDAIBN1lwf//WMDS6MGjc9imkwnHJ2heXz8Tx1ZGRANgO8gzkgWWISWyVliNMYK1CiQdYVQ9pZJnNfeFRJUM94Xa/7kADEIBZKso41sAAAAASUVORK5CYII=", -1, 4);
global.sprThunderCloudPistol_2 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLSYrr/ulOKcAAAAAXRSTlMAQObYZgAAAFFJREFUeNq1jUEKwEAIAxvXaP//4kYRoYceOxdxEvT6BM1rjVsEVrkhG2XrwFCJnhhjRp6IQxLTccs0kUyILkGqAtYoJVbtAzgh2JWhw77zPw87jwGjhE0v2wAAAABJRU5ErkJggg==", -1, 4);
global.sprThunderCloudPistol_3 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLSYrr/ulOKcAAAAAXRSTlMAQObYZgAAAFNJREFUeNq1jEEOgDAMw0jXpPz/xWSFTeLAEd/qWjk+QfM6dRphqwxUA2A7UI6YhcdEkDIk8TQZVUMaxYLpyFNhrCJzKmPl9q7WPmE4k0U/e+d/LkTDAa8ezhxlAAAAAElFTkSuQmCC", -1, 4);
global.sprThunderCloudPistol_4 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLSYrr/ulOKcAAAAAXRSTlMAQObYZgAAAFJJREFUeNq1zDEOgDAMQ1GcxjH3PzEmLZUYGHlbrK8cn9BeZ51W2FMG1ADsDSxHTGEtEZwTidVkSGWiYB1BGlXDU2Tek0lhs3r+E8ZOFmDlx/8uUDEBv6l7+AoAAAAASUVORK5CYII=", -1, 4);
global.sprThunderCloudPistol_5 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLSYrr/ulOKcAAAAAXRSTlMAQObYZgAAAFNJREFUeNq1zDEOwCAMQ1Ec4rj3P3ENBaQOHfu2fFlpnzC9zrqscFIGNAE4DSyPmMIqEXwSibXJkEYSBZsjOJlTZI5kUq/qz2r/J4xjsgFr3v53A1xdAdP49gCjAAAAAElFTkSuQmCC", -1, 4);
global.sprThunderCloudPistol_6 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLSYrr/ulOKcAAAAAXRSTlMAQObYZgAAAFBJREFUeAG1zDsSgEAIg+ENS8D7n9iIrI/C0q8j8w/jE8rrjE3i2uCGLHcIB0MRPdGLGc+JRDdumSHJhFQETao0mfsxybNa/zkjJitpWMb/dmb6AenlxXm6AAAAAElFTkSuQmCC", -1, 4);
global.sprThunderCloudPistol_7 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLSYrr/ulOKcAAAAAXRSTlMAQObYZgAAAFRJREFUeNqtzEESgDAIQ1FDCXj/Exuw7ejCnW/HnwzHJ7TXGacEdnJDNgC7gaERPTGLGe9EYm7cMislE9IjKImSuVeS52r9ZwhrsgAjYqzJjrr/dwFzcgIFtmA9wAAAAABJRU5ErkJggg==", -1, 4);
global.sprThunderCloudPistol_8 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLSYrr/ulOKcAAAAAXRSTlMAQObYZgAAAFhJREFUeNqlj0kOgEAIBKcZGvz/iwVkXGI8WTcqlU4Yn6B4nLYFhlOpwIsrhIIWEdXRRoSHItGNinsqpyOoCKGCUKKaKrhXa59ZsZIGSNVJg2k28f5o/GQHfEcCHzk1ckAAAAAASUVORK5CYII=", -1, 4);
global.sprThunderCloudPistol_9 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLSYrr/ulOKcAAAAAXRSTlMAQObYZgAAAFtJREFUeNqVj0kOwDAIxDKEgf7/xYWsjaoe6huWhTTlEzSO067AsJQKvLFDKGgRUR3DiLArEqNRcU/ldAQtQqgglKimCp7V/M+smMkESJXJpqtzUDWreI8sf7gBgy4COQiCExQAAAAASUVORK5CYII=", -1, 4);
global.sprThunderCloudPistol_X = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAMAAAAs2N9uAAAAG1BMVEUAAAAAAAAiERArOU80IR5HLy1PY3lnRD+Yrr80vUOIAAAAAXRSTlMAQObYZgAAAFpJREFUeNp9j0EOgDAIBLuUBf//YgFbqzF1bkwmm9C2oHiddgSGW6nAixVCQYuI6hhGhJciMRoV91ROR1ARQgWhRDVV8KzmPrNiJhMgVSaLUin+VTfr+P7dtpyIJwJThhSg2AAAAABJRU5ErkJggg==", -1, 4);

global.sprTCPBullet = sprite_add_base64("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAMAAACROYkbAAAADFBMVEUAAAArOU9PY3mYrr+zfeouAAAAAXRSTlMAQObYZgAAAGNJREFUeAHlkzEWgDAIQ/nx/ne2VeGlI4/RvyWGDBZigx6IFxY6LAKC1ObV+LX4vsOSibC8ShdbWl4i6xJ5WqUdz0utgnQNAc0CnQWKdkFlc4D/FUx/4vgZx4s0X+XhMY3P+QYLsQVRZWlBggAAAABJRU5ErkJggg==",4,8,8);

global.TCPBulletGlower = noone;

#define weapon_name
return "THUNDER CLOUD PISTOL";

#define weapon_sprt
with(self) if (instance_exists(Player)) && ("wep" in self) && ((wep = "thunder cloud pistol") || (bwep = "thunder cloud pistol")) && ("TCPAmmo" in self) && (TCPAmmo < 9.5){
	if TCPAmmo > 8.5 return global.sprThunderCloudPistol_9;
	else if TCPAmmo > 7.5 return global.sprThunderCloudPistol_8;
	else if TCPAmmo > 6.5 return global.sprThunderCloudPistol_7;
	else if TCPAmmo > 5.5 return global.sprThunderCloudPistol_6;
	else if TCPAmmo > 4.5 return global.sprThunderCloudPistol_5;
	else if TCPAmmo > 3.5 return global.sprThunderCloudPistol_4;
	else if TCPAmmo > 2.5 return global.sprThunderCloudPistol_3;
	else if TCPAmmo > 1.5 return global.sprThunderCloudPistol_2;
	else if TCPAmmo > 0.5 return global.sprThunderCloudPistol_1;
	else return global.sprThunderCloudPistol_0;
}
else return global.sprThunderCloudPistol_X;

#define weapon_type
return 0;

#define weapon_melee
return false;

#define weapon_auto
return true;

#define weapon_load
return 7.5;

#define weapon_cost
return 0;

#define weapon_swap
return sndSwapMachinegun;

#define weapon_area
return 25;

#define weapon_text
return "STATIC SHOCK";

#define weapon_fire
if TCPAmmo > 0 {
	if !instance_exists(global.TCPBulletGlower) {
		global.TCPBulletGlower = instance_create(0, 0, CustomObject);
		with(global.TCPBulletGlower){
			script_bind_draw(TCPBulletGlow, 0.1);
		}
	}
	with instance_create(x+lengthdir_x(2, gunangle),y+lengthdir_y(2, gunangle),CustomProjectile){
		motion_add(other.gunangle + random_range(-5,5)*other.accuracy,15 + 2.5*skill_get(13));
		image_angle = direction;

		team = other.team;
		creator = other;

		sprite_index = global.sprTCPBullet;
		mask_index = mskBullet1;
		
		damage = 4;
		force = 4;
		
		on_hit = script_ref_create(TCPHurt);
		on_wall = script_ref_create(TCPWall);
		
		canthurt = noone;
		hurttime = -1;
		
		time = 4;
		
		script_bind_step(TCPbullet, 0, id);
	}
	sound_play_gun(sndOasisShoot, 0.25, 0.5);
	motion_add(other.gunangle,-2)
	wkick = 10;

	TCPAmmo -= 0.5;
	
}
else with instance_create(x,y,PopupText){
	mytext = "EMPTY";
	time = 15;
}
wkick = 8;

#define step
with(Player) if (wep = "thunder cloud pistol") || (bwep = "thunder cloud pistol") {
	if "TCPAmmo" not in self TCPAmmo = 10 + 10*skill_get(10);
	
	if (((wep = "thunder cloud pistol") && wkick <= 0) || (wep != "thunder cloud pistol")) && (TCPAmmo < 10 + 10*skill_get(10)) {
		TCPAmmo += 0.04;
	}
}

#define TCPbullet(Me)
with (Me) {
	image_angle = direction;

	if speed > 0 speed -= speed/10;
	
	if (speed > 1) && ((image_index > 1) && (image_index < 2)) image_speed = 0;
	else image_speed = 0.5;
	
	time += 1;
	if time = 8 {
		time = 0;
		sound_play_pitchvol(sndLightningPistol, random_range(2, 4), 0.4);
		with instance_create(x+lengthdir_x(speed*3,direction),y+lengthdir_y(speed*3,direction),Lightning){
			move_contact_solid(other.direction + 180, 10);
			team = other.team;
			creator = other
			ammo = 4;
			image_angle = other.direction + 180 + (random_range(-30, 30));
			
			alarm0 = 1;
			with instance_create(x,y,LightningSpawn) image_angle = other.image_angle;
		}
	}
	
	if image_index > 3 instance_destroy();
	
	with(projectile) if instance_exists(self) && instance_exists(other) && (team != other.team) && (distance_to_object(other) < 15) {
		instance_destroy();
		other.speed /= (1.5 - 0.25*skill_get(13));
	}
	
	if (instance_exists(self)) && (hurttime >= 0) hurttime -= 1;
	if (instance_exists(self)) && (hurttime = 0) && (canthurt != noone) canthurt = noone;
}
if (!instance_exists(Me)) {
	instance_destroy();
}

#define TCPBulletGlow
with(CustomProjectile) if sprite_index = global.sprTCPBullet {
	draw_set_blend_mode(bm_add);
	draw_sprite_ext(sprite_index, image_index, x, y, 1.5, 1.5, direction, c_white, 0.1);
	draw_set_blend_mode(bm_normal);
}

#define TCPHurt
if canthurt != other {
	projectile_hit(other, damage, force, direction);
	canthurt = other;
	hurttime = 10;
}

#define TCPWall
speed = 0;