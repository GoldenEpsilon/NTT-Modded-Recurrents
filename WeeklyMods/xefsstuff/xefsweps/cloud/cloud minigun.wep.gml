#define init
global.sprCloudMinigun_0 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABoAAAAQCAMAAAA/D5+aAAAALVBMVEUAAAAyJxpUQix/ZEOfw92vj2rg7vgAAAAyJxpUQix/ZEOfw92vj2rg7vj////6HFM0AAAAB3RSTlMAAAAAAAAAVWTqWAAAAJxJREFUGBkFwYGR3DAMBDCQpl/9l+u5iBugeGHbtrQt9+HWfagkyVSHdIdC73CVehvraTbIaoi3iCW6F3sN+GvWdwgsGAC+8wL4MABx8A/jhW84iG67lOzD0z/jTMNua4u+ZGmSJKkIoKhmfOdSqhYJQpbhw6mEy+fcfSyGaQIC1pI1JAj84POy24Z7qxBqfvhzSxieXg2bfSgs6z9SImMus7XzzAAAAABJRU5ErkJggg==", 4, 3);
global.sprCloudMinigun_1 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABoAAAAQCAMAAAA/D5+aAAAALVBMVEUAAAAyJxpUQix/ZEOfw92vj2rg7vgAAAAyJxpUQix/ZEOfw92vj2rg7vj////6HFM0AAAAB3RSTlMAAAAAAAAAVWTqWAAAAJxJREFUGBkFwYFtxDAMBDBKUZr9xzUe1pUsXti2LW3Lfbh1HypJMtUh3aHQO1yl3sZ6mg2yGuItYonuxV4D/pp1PgILBoDzvQAOBiA+pG154RQfSrdl0dr274xvGnZb25K+ZGmSJKkIoKhmnO9SqhYJQpbh4KuEy/HdfSyGaQIC1pI1JAj84HjZbcO9VQg1P/y5JQxPr4bNPhSW9Q8RqGQkpp56uwAAAABJRU5ErkJggg==", 4, 3);
global.sprCloudMinigun_2 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABoAAAAQCAMAAAA/D5+aAAAAMFBMVEUAAAAyJxpUQix/ZEOfw92vj2rg7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj////f+aSxAAAAB3RSTlMAAAAAAAAAVWTqWAAAAJ9JREFUGBkFwYFhw0AIBDCBcbz/uG7yR6XihrS0bSnn4tS5qN3dneplu5dCZzhK3Y24miw2GtZdrLC6gxwDPk28DwsBA8D7fAC8GID1YFvKB97hwbpaYkkN03/GczckrX3D/WtBs7u7WxFU0XQzXijVwS7SguHFU3v48Xp+IWGYZsGCCBvF1QBf4G5Jf4dzqrDUfPFxyjJcHQ3ZXBRC/AO4nmA0+V/oKQAAAABJRU5ErkJggg==", 4, 3);
global.sprCloudMinigun_3 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABoAAAAQCAMAAAA/D5+aAAAAMFBMVEUAAAAyJxpUQix/ZEOfw92vj2rg7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj////f+aSxAAAAB3RSTlMAAAAAAAAAVWTqWAAAAJ5JREFUGBkFwYGBwyAMBDDZkGb/cfmW80vFA2lp01Lu4tZd1MzM7OphuodCZ3OVehqxmgwmGsZTjDC6g1wbfJo4LwMBG4DzfgAcbIDxYlrKB07xoqwWCqOl/872Pg1Ja7dl/VqwmYG6nZawmm62A6U6GEgLNgdvzeXH8f5CwmY3AwZEmChWA3yBpyX93dxbhaH2Fx+3DJvV0ZDJohDiH5+xXDG74LaAAAAAAElFTkSuQmCC", 4, 3);
global.sprCloudMinigun_4 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABoAAAAQCAMAAAA/D5+aAAAAMFBMVEUAAAAyJxpUQix/ZEOfw92vj2rg7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj////f+aSxAAAAB3RSTlMAAAAAAAAAVWTqWAAAAJ5JREFUGBkFwYFhw0AIBDCBcbz/uG7yR6XihrS0bSnn4tS5qN3dneplu5dCZzhK3Y24miw2GtZdrLC6gxwDPk28DwsBA8D7fAC8GID1YFvKB97hwbpaopBh+s947oaktQ39a0Gzu7tbEUI03YwXSnVwDldaMLx4ag8/Xs8vJAzTLFgQYaO4GuAL3C3p73BOFZaaLz5OWYaroyGbi0KIfynEYS+U3iI1AAAAAElFTkSuQmCC", 4, 3);
global.sprCloudMinigun_5 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABoAAAAQCAMAAAA/D5+aAAAAMFBMVEUAAAAyJxpUQix/ZEOfw92vj2rg7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj////f+aSxAAAAB3RSTlMAAAAAAAAAVWTqWAAAAJ1JREFUGBkFwYGB20AMAzCIvsT7j+tPTRUYPtBobHS8F++8F7O7u2eybLIM0sNrzCeoK3SxFVifYZWVFH0d8A313CwUHACe+wvgwQFYNzY6vvAcbqwrWoMeTv4c9yfQRizyL4rDLsybhiIkHA+MSdHo1SgGuAdGkX798RxOWLA87ipbwxWAH/CJNr/D+85gmfPD1zuWw5UKdHsxKPUf2epXTrpAXmwAAAAASUVORK5CYII=", 4, 3);
global.sprCloudMinigun_6 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABoAAAAQCAMAAAA/D5+aAAAAMFBMVEUAAAAyJxpUQix/ZEOfw92vj2rg7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj////f+aSxAAAAB3RSTlMAAAAAAAAAVWTqWAAAAJ1JREFUGBkFwYFhw0AIBDCBcbz/uG7yR6XihrS0bSnn4tS5qN3dneplu5dCZzhK3Y24miw2GtZdrLC6gxwDPk28DwsBA8D7fAC8GID1YFvKB97hwbpaopBh+s947oaktQ39a0Gzu7tbEXTTdDNeKNWBIC0YXjy1h59q2ZAwTLNgORA2hl0sfIH7J2nDOVVYar74OGUZro6GbC4KIf4BLXFhNbD9EAsAAAAASUVORK5CYII=", 4, 3);
global.sprCloudMinigun_7 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABoAAAAQCAMAAAA/D5+aAAAAMFBMVEUAAAAyJxpUQix/ZEOfw92vj2rg7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj////f+aSxAAAAB3RSTlMAAAAAAAAAVWTqWAAAAJ1JREFUGBkFwQECgjAMBLC0G/D/56LualJckJY2LeUsTp1FzczMrh6meyh0NkepqxGryWCiYVzFCKM7yLHB3cT7MBCwAXifG8CLDTAeTEu54d08GKslCtns/tieqyFpbdC/FmxmoE6nCZputhdKdaBFWlDAU1AWTm4f3s1uBoxqiTCxmcHA13N4r5+kFVRhsL+4pZz13ayOhkwWhRB/XZhaRC/Z/dQAAAAASUVORK5CYII=", 4, 3);
global.sprCloudMinigun_8 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABoAAAAQCAMAAAA/D5+aAAAAMFBMVEUAAAAyJxpUQix/ZEOfw92vj2rg7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj////f+aSxAAAAB3RSTlMAAAAAAAAAVWTqWAAAAJxJREFUGBkFwYFhw0AIBDCBcbz/uE7zR6XihrS0bSnn4tS5qN3dneplu5dCZzhK3Y24miw2GtZdrLC6gxwDPk28DwsBA8D7fAC8GID1YFvKB97hwbpaopBh+ms8d0PS2qJ/LRh2oU6nCZpuxgulOtAiLSjgKSgXTj6+vMM0C9aFCBvDLhb+nrTIT9KGc6qwVBy2TlmGq6Mhm1BNiH/g7V47maVw4AAAAABJRU5ErkJggg==", 4, 3);

global.sprCMBullet = sprite_add_base64("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAMAAACROYkbAAAAD1BMVEUAAAByn79yn7+fw93////aoC5MAAAAAnRSTlMAAHaTzTgAAAB0SURBVHjapZNJDsAgDAPtwP/f3ASaWtwqPOJChEdhQ8GxIO6o+ExuFaz45s5QeRmQRIwmsAhEjm+uWsLKy8CKy/kmCJag510johtQCzuvghZzGU4BUzAPxplXgBKIXwIhgbAF9hbsQ7Sv0X1I/lP2P5P9nR9gHAXx4iI11QAAAABJRU5ErkJggg==",4,8,8);

global.CMBulletGlower = noone;

#define weapon_name
return "CLOUD MINIGUN";

#define weapon_sprt
with(self) if (instance_exists(Player)) && ("wep" in self) && ((wep = "cloud minigun") || (bwep = "cloud minigun")) && ("CMAmmo" in self) && (CMAmmo < 7.5){
	if CMAmmo > 6.5 return global.sprCloudMinigun_7;
	else if CMAmmo > 5.5 return global.sprCloudMinigun_6;
	else if CMAmmo > 4.5 return global.sprCloudMinigun_5;
	else if CMAmmo > 3.5 return global.sprCloudMinigun_4;
	else if CMAmmo > 2.5 return global.sprCloudMinigun_3;
	else if CMAmmo > 1.5 return global.sprCloudMinigun_2;
	else if CMAmmo > 0.5 return global.sprCloudMinigun_1;
	else return global.sprCloudMinigun_0;
}
else return global.sprCloudMinigun_8;

#define weapon_type
return 0;

#define weapon_melee
return false;

#define weapon_auto
return true;

#define weapon_load
return 20;

#define weapon_cost
return 0;

#define weapon_swap
return sndSwapMachinegun;

#define weapon_area
if GameCont.hard < 35 {
	return 19;
}
return -1;

#define weapon_text
return "I HAVE NEW CLOUD";

#define weapon_fire
if CMAmmo >= 8 {
	canswap = 0;
	if !instance_exists(global.CMBulletGlower) {
		global.CMBulletGlower = instance_create(0, 0, CustomObject);
		with(global.CMBulletGlower){
			script_bind_draw(CMBulletGlow, 0.1);
		}
	}
	repeat(32) if(instance_exists(self)){
		with instance_create(x+lengthdir_x(1, gunangle),y+lengthdir_y(1, gunangle) + 6,CustomProjectile){
			motion_add(other.gunangle + random_range(-10,10)*other.accuracy,15 + 5*skill_get(13));
			image_angle = direction;

			team = other.team;
			creator = other;

			sprite_index = global.sprCMBullet;
			mask_index = mskBullet1;
		
			damage = 2;
			force = 2;
		
			on_hit = script_ref_create(CMHurt);
			on_wall = script_ref_create(CMWall);

			canthurt = noone;
			hurttime = -1;
			
			script_bind_step(CMbullet, 0, id);
		}
		sound_play_gun(sndOasisShoot, 0.25, 0.5);
		motion_add(other.gunangle,-2)
		wkick = 15;
		
		CMAmmo -= 0.25;
		wait(2);
	}
	canswap = 1;
}
else with instance_create(x,y,PopupText){
	mytext = "EMPTY";
	time = 15;
}
wkick = 10;

#define step
with(Player) if (wep = "cloud minigun") || (bwep = "cloud minigun") {
	if "CMAmmo" not in self CMAmmo = 8 + 8*skill_get(10);
	
	if (((wep = "cloud minigun") && wkick <= 0) || (wep != "cloud minigun")) && (CMAmmo < 8 + 8*skill_get(10)) {
		CMAmmo += 0.03;
	}
}

#define CMbullet(Me)
with(Me) {
	image_angle = direction;

	if speed > 0 speed -= speed/10;
	
	if (speed > 1) && ((image_index > 1) && (image_index < 2)) image_speed = 0;
	else image_speed = 0.5;
	
	if image_index > 3 instance_destroy();
	
	with(projectile) if instance_exists(self) && instance_exists(other) && (team != other.team) && (distance_to_object(other) < 7.5) {
		instance_destroy();
		other.speed /= (1.5 - 0.25*skill_get(13));
	}
	
	if (instance_exists(self)) && (hurttime >= 0) hurttime -= 1;
	if (instance_exists(self)) && (hurttime = 0) && (canthurt != noone) canthurt = noone;
}
if (!instance_exists(Me)) {
	instance_destroy();
}

#define CMBulletGlow
with(CustomProjectile) if sprite_index = global.sprCMBullet {
	draw_set_blend_mode(bm_add);
	draw_sprite_ext(sprite_index, image_index, x, y, 1.5, 1.5, direction, c_white, 0.1);
	draw_set_blend_mode(bm_normal);
}

#define CMHurt
if canthurt != other {
	projectile_hit(other, damage, force, direction);
	canthurt = other;
	hurttime = 10;
}

#define CMWall
speed = 0;