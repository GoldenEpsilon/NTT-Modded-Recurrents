#define init
global.sprCloudShotgun_0 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAKlBMVEUAAAAyJxpUQixyn79/ZEOfw92vj2oAAAAyJxpUQix/ZEOfw92vj2rg7vjStuILAAAAB3RSTlMAAAAAAAAAVWTqWAAAAHFJREFUeNp9zksShDAIRVGC4SOm97/dhkd04MBTJaVXUemTwfv6+qXLmmQ9ky8ITNO7hqc4o9js6r68FrzYqPfibNfaM34+tzDePxKGMUk6MDMW6hDSyaqKymMQCE2eqSvvetCA+9mddXChvltBkhL8AYGXBPuWHhw+AAAAAElFTkSuQmCC", 3, 2);
global.sprCloudShotgun_1 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAKlBMVEUAAAAyJxpUQixyn79/ZEOfw92vj2oAAAAyJxpUQix/ZEOfw92vj2rg7vjStuILAAAAB3RSTlMAAAAAAAAAVWTqWAAAAHJJREFUeNp9jkEShDAIBAMSQJL9/3d3APXgwT5MJc1UwfjEivd//cCyZsKewHcRlaa3jYVqnJGYtHXf7hXAaMDWaztmCGD8rNsV70PCKmTMFsycGjZPUmFVhQVEVUBRWEBbvuwxqLi7l1biZPQ0xQTawz+NOAUJ7PNK4gAAAABJRU5ErkJggg==", 3, 2);
global.sprCloudShotgun_2 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAALVBMVEUAAAAyJxpUQixyn79/ZEOfw92vj2oAAAAyJxpUQixyn79/ZEOfw92vj2rg7viKXI14AAAAB3RSTlMAAAAAAAAAVWTqWAAAAHRJREFUeNp9jssOwyAMBI3rVwLu/39u7CXpIYeOxAqGtYD+4uB9Xt9i+UbLHkUkmEi3x85V1XnMxmXbiDzXOjMaH1QWO4iMnnP+PZeI90emI4R0C2bGQC8lEzYzWB6DgJKwFNvybT80wNO9tQ2UaN+20MIIXLMSBTjHeeknAAAAAElFTkSuQmCC", 3, 2);
global.sprCloudShotgun_3 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAMFBMVEUAAAAyJxpUQixyn79/ZEOfw92vj2oAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9J7T27AAAAB3RSTlMAAAAAAAAAVWTqWAAAAHRJREFUeNp9zkkSxCAIQFGgFTBC7n/cMCS9yCJvQenXKoVPUt57O4NJm1FXUC+7pvBTt8XVvXaS0VXVLbgmQYhaKz/MDtcVhP7PeY33R7bUGDA7EFHmrDKBBzFzVUKEMmHQCF3prj/A8ty9MyMl6NMMMzCUC73CBUhmy7bkAAAAAElFTkSuQmCC", 3, 2);
global.sprCloudShotgun_4 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAMFBMVEUAAAAyJxpUQixyn79/ZEOfw92vj2oAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9J7T27AAAAB3RSTlMAAAAAAAAAVWTqWAAAAHRJREFUeNp9zsEOAyEIRVGkAjpA//9zy8OZzSx6EhO9GiL9Ze19jm8JO6TqLiubJ5g+1aOe+naweepaiZoLbGBu7zJKrl2MCRnyirjy/RG3golyAjMjG5aQTlbVrjwGNaHJs1SFu35otOftnXUw0LlFkKLUftLjBW5iWNhoAAAAAElFTkSuQmCC", 3, 2);
global.sprCloudShotgun_5 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAMFBMVEUAAAAyJxpUQixyn79/ZEOfw92vj2oAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9J7T27AAAAB3RSTlMAAAAAAAAAVWTqWAAAAHBJREFUeAF9zjEWAyEIRVEkCjpA9r/cfFCbKXIrfXJU+kvLe+9fcN0G6oIZxSKp3GoYdluWtO86Z2SNmbQRaq1OXaB8n0OFeH/EHvcnbxxUmDlzGSSdRaQqt0ZlUOcOu/KpH2rlzp4sjRPt0wwDhMoP5MAFlNZeEfcAAAAASUVORK5CYII=", 3, 2);
global.sprCloudShotgun_6 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAMFBMVEUAAAAyJxpUQixyn79/ZEOfw92vj2oAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9J7T27AAAAB3RSTlMAAAAAAAAAVWTqWAAAAHRJREFUeNp9zkEWwyAIRVGgChqg+19uP9h0kEHvSF84RPrL2vMebwg7JuqGlc2zmN7VA6O+vdg4da2smqsY194+ZUCuDSa/353Z50M8oDbOE0Sk8hVx4Uk6RFVRgbn3YHDIANTO1F7E7Z79ZmUpdL5WmKDUPvUABcTFH/kyAAAAAElFTkSuQmCC", 3, 2);
global.sprCloudShotgun_7 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAMFBMVEUAAAAyJxpUQixyn79/ZEOfw92vj2oAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9J7T27AAAAB3RSTlMAAAAAAAAAVWTqWAAAAHNJREFUeAF9zkESAyEIRNGGKDgj5P7HTYPJZhZ5K/xlUeAvb893vCn8mKwXrWw7i9uvbn6Ofe3i49S1smqu4gLWnr71IleQEyvl85DeWxsnmqpWDvIJG2pmrCTid8TNOnRQV2Y44QVpp9bQTLQAUipMMrQPCAIGBoexohEAAAAASUVORK5CYII=", 3, 2);
global.sprCloudShotgun_8 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAMFBMVEUAAAAyJxpUQixyn79/ZEOfw92vj2oAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9J7T27AAAAB3RSTlMAAAAAAAAAVWTqWAAAAHNJREFUeNp9zjEWxCAIRVFgFDRi9r/cfGBsUuRW+vSg9MnSe+83uJWOOmHstHYwPXU5rq65grWqY+yoewTjmJurf51gcp5Dhf3+SM3FxF5BRCI74EvaRFVRgfnUJg1QM9vlftmPOJ27XO8oSyCqQ4QOSukBE2MGRFvBaugAAAAASUVORK5CYII=", 3, 2);

global.sprCSBullet = sprite_add_base64("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAMAAACROYkbAAAAFVBMVEUAAAByn7+fw93///9yn7+fw93///89T4TsAAAABHRSTlMAAAAAs5NmmgAAAIJJREFUeNrdk0sOgCAMRBkYvP+RnfJxFqxId75oTMf2hSiUgH3AUQAU3ZFgoS7XAUHiG3/EfK9Y5cYTIXBti273y7B0NhQsKobBw0oAPaPfhkOAKlpwCJRVlEhNJ3kK2mQLNpHXtQAvAbeC3e0B3gjwA0H6I6Z/Y3Yjpbdy/jClj/MLKLcNp/ErVaUAAAAASUVORK5CYII=",4,8,8);

global.CSBulletGlower = noone;

#define weapon_name
return "CLOUD SHOTGUN";

#define weapon_sprt
with(self) if (instance_exists(Player)) && ("wep" in self) && ((wep = "cloud shotgun") || (bwep = "cloud shotgun")) && ("CSAmmo" in self) && (CSAmmo < 7.5){
	if CSAmmo > 6.5 return global.sprCloudShotgun_7;
	else if CSAmmo > 5.5 return global.sprCloudShotgun_6;
	else if CSAmmo > 4.5 return global.sprCloudShotgun_5;
	else if CSAmmo > 3.5 return global.sprCloudShotgun_4;
	else if CSAmmo > 2.5 return global.sprCloudShotgun_3;
	else if CSAmmo > 1.5 return global.sprCloudShotgun_2;
	else if CSAmmo > 0.5 return global.sprCloudShotgun_1;
	else return global.sprCloudShotgun_0;
}
else return global.sprCloudShotgun_8;

#define weapon_type
return 0;

#define weapon_melee
return false;

#define weapon_auto
return true;

#define weapon_load
return 20;

#define weapon_cost
return 0;

#define weapon_swap
return sndSwapMachinegun;

#define weapon_area
if GameCont.hard < 31 {
	return 15;
}
return -1;

#define weapon_text
return "A BLAST OF REFRESHMENT";

#define weapon_fire
if CSAmmo > 0 {
	if !instance_exists(global.CSBulletGlower) {
		global.CSBulletGlower = instance_create(0, 0, CustomObject);
		with(global.CSBulletGlower){
			script_bind_draw(CSBulletGlow, 0.1);
		}
	}
	var cloudangle = 20*other.accuracy
	repeat(2) if(instance_exists(self)){
		repeat(2){
			with instance_create(x+lengthdir_x(2, gunangle),y+lengthdir_y(2, gunangle),CustomProjectile){
				motion_add(other.gunangle + random_range(-5,5)*other.accuracy + cloudangle,10 + 5*skill_get(13));
				image_angle = direction;

				team = other.team;
				creator = other;

				sprite_index = global.sprCSBullet;
				mask_index = mskBullet1;
		
				damage = 6;
				force = 8;
		
				on_hit = script_ref_create(CSHurt);
				on_wall = script_ref_create(CSWall);
				
				canthurt = noone;
				hurttime = -1;
				
				script_bind_step(CSbullet, 0, id);
			}
			cloudangle *= -1;
		}
		cloudangle /= 2;		
	}
	sound_play_gun(sndOasisShoot, 0.25, 0.5);
	motion_add(other.gunangle,-4)
	wkick = 22;

	CSAmmo -= 1;
	
}
else with instance_create(x,y,PopupText){
	mytext = "EMPTY";
	time = 15;
}
wkick = 20;

#define step
with(Player) if (wep = "cloud shotgun") || (bwep = "cloud shotgun") {
	if "CSAmmo" not in self CSAmmo = 8 + 8*skill_get(10);
	
	if (((wep = "cloud shotgun") && wkick <= 0) || (wep != "cloud shotgun")) && (CSAmmo < 8 + 8*skill_get(10)) {
		CSAmmo += 0.03;
	}
}

#define CSbullet(Me)
with(Me) {
	image_angle = direction;

	if speed > 0 speed -= speed/10;
	
	if (speed > 1) && ((image_index > 1) && (image_index < 2)) image_speed = 0;
	else image_speed = 0.5;
	
	if image_index > 3 instance_destroy();
	
	with(projectile) if instance_exists(self) && instance_exists(other) && (team != other.team) && (distance_to_object(other) < 15) {
		instance_destroy();
		other.speed /= (1.5 - 0.25*skill_get(13));
	}
	
	if (instance_exists(self)) && (hurttime >= 0) hurttime -= 1;
	if (instance_exists(self)) && (hurttime = 0) && (canthurt != noone) canthurt = noone;
}
if (!instance_exists(Me)) {
	instance_destroy();
}

#define CSBulletGlow
with(CustomProjectile) if sprite_index = global.sprCSBullet {
	draw_set_blend_mode(bm_add);
	draw_sprite_ext(sprite_index, image_index, x, y, 1.5, 1.5, direction, c_white, 0.1);
	draw_set_blend_mode(bm_normal);
}

#define CSHurt
if canthurt != other {
	projectile_hit(other, damage, force, direction);
	canthurt = other;
	hurttime = 10;
}

#define CSWall
speed = 0;