#define init
global.sprThunderCloudRifle_0 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAGFBMVEUAAAAAAAAiERA0IR5HLy1OYHRnRD+QpLT+OupDAAAAAXRSTlMAQObYZgAAAFZJREFUeNrFzjEOwDAIQ9FgE3r/G9eWUEqnjn0LUn4SsT7ENE/39dhxAllD9psQpEE0WB1IgLpYIKHBDHFwGQGadIDECGFn0+ofHNYQ6WNP8h3Giut/NyzuAhfpv3vXAAAAAElFTkSuQmCC", 3, 3);
global.sprThunderCloudRifle_1 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAGFBMVEUAAAAAAAAiERA0IR5HLy1OYHRnRD+QpLT+OupDAAAAAXRSTlMAQObYZgAAAFdJREFUeNrFjkEOgEAIA7eUxf//2NboLp48OpcSpiGMD9Dp23lsJpYgq5HAuhJpptoKFp5+BFWsEAomhIXNJTQ4lLQIgSZg1qd1X7AYDaTXTvIt2ovjf048ywIlv77MpwAAAABJRU5ErkJggg==", 3, 3);
global.sprThunderCloudRifle_2 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAFtJREFUeNrFjkkOgDAMA+s0C/9/MTaCNpw4MhdLHivK+ACd3uaxSSzhXo0A1hULkVwzvPDszZzDmpmT4QEiISNh5Ao2EkYgwUICYn1a9wWJ0UCoVrq/RXtx/M8JoGQChYVbtVQAAAAASUVORK5CYII=", 3, 3);
global.sprThunderCloudRifle_3 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAFtJREFUeNrFjjkOgEAMA+NsDv7/YmwJllBRMo0ljxXFPsBktnU8FLaI6EEC+4qnKK4Z0bj37sFhF2FEgkjISKyqxXBnI+EEEk4YEPvTvi5I2ACpWhnxFuNF+58TrHQCkZ4qDsUAAAAASUVORK5CYII=", 3, 3);
global.sprThunderCloudRifle_4 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLT///92cBK8AAAAAXRSTlMAQObYZgAAAFtJREFUeNrFjkkOgDAMA+s0C/9/MTaCNpw4MhdLHivK+ACd3uaxSSzhXo0A1hULkVwzvPDszZzDkmB4gEjIXIIwzNhIGIHEzJwMiPVp3RckRgOhWun+Fu3F8T8nvlgCpb2b+poAAAAASUVORK5CYII=", 3, 3);
global.sprThunderCloudRifle_5 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLT///92cBK8AAAAAXRSTlMAQObYZgAAAFtJREFUeNrFjkkOwDAMAoPjpf9/cSFSE/fUY+eC5EHI4wN0+jWvQ2IL92oEsFcsRLLN8MLTN3MWS4LhASIh04QZLxJGsARhQOxPiwszc0qMBiKwCPe3aC+O/7kB0nUCv2RVmFoAAAAASUVORK5CYII=", 3, 3);
global.sprThunderCloudRifle_6 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLT///92cBK8AAAAAXRSTlMAQObYZgAAAFxJREFUeNrFj0kOgDAMA3Gahf+/GLuCkBtH5mIpXtQeH2Ayr3m+JNpwr0EAvWIhkmmKF568mTNYMigeIDLkbINQzHiRYQSjAdEvLS7cDRwDRAArc4VWBrvc//udC+DgAtYJVcCgAAAAAElFTkSuQmCC", 3, 3);
global.sprThunderCloudRifle_7 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLT///92cBK8AAAAAXRSTlMAQObYZgAAAGFJREFUeNq9jkkOwCAMA3HI0v+/uDYSNFIPvXUuRplgGB+g06d5PSSOcK9GAKfFQiS3GV7Y+2bOxZJgeIBIyDRhxomEESxBGBD7pxSuN5YYDUQASUItDV3GzJw6vFjdf3ID8bcC8+EZpQoAAAAASUVORK5CYII=", 3, 3);
global.sprThunderCloudRifle_8 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLT///92cBK8AAAAAXRSTlMAQObYZgAAAGVJREFUeNq1kEkOwCAMA3HI0v+/uDYSNJeqp87FUiYkwPgAnV7N6yFxhHs1AjhTLESym+GF3W/mbCwJhgeIhEwTZqxIGMEShAGxb0rh2rHEaCACSBKa0tDhJc77upyZE2//Mn7gBv08Aw3IqOvEAAAAAElFTkSuQmCC", 3, 3);
global.sprThunderCloudRifle_9 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLT///92cBK8AAAAAXRSTlMAQObYZgAAAGhJREFUeNqdkFEOgDAIQ1cGzPuf2HbRSYzGxPfThQdkoX2ASq3mdpFYwn0UAlhbLESym+EDZ7+Zs3FIMDxAJGSKMGNFwgimIAyI86cUHscEWgERQJLQloKGp9DjxiGeztIzO94O1v6zAwZGAyfvydyJAAAAAElFTkSuQmCC", 3, 3);
global.sprThunderCloudRifle_X = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABgAAAAQCAMAAAA7+k+nAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLSYrr/ulOKcAAAAAXRSTlMAQObYZgAAAGdJREFUeNqNkFEKwDAIQxurdvc/8ZKydTIY3ftJ8alI2wZUajWPh8QS7qMQwNpiIZLdDB+4+82cjUOC4QEiIVOEGSsSRjAFYUDcl1J4XBNoBUQASUJbChqeQo83U6j8X/TMjq+fbFtODLcDQfD6qgEAAAAASUVORK5CYII=", 3, 3);

global.sprTCRBullet = sprite_add_base64("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAMAAACROYkbAAAAElBMVEUAAAByn78rOU9PY3mYrr////91wG3ZAAAAAnRSTlMAAHaTzTgAAAB0SURBVHjapZNJDsAgDAPtwP/f3ASaWtwqPOJChEdhQ8GxIO6o+ExuFaz45s5QeRmQRIwmsAhEjm+uWsLKy8CKy/kmCJag510johtQCzuvghZzGU4BUzAPxplXgBKIXwIhgbAF9hbsQ7Sv0X1I/lP2P5P9nR9gHAXx4iI11QAAAABJRU5ErkJggg==",4,8,8);

global.TCRBulletGlower = noone;

#define weapon_name
return "THUNDER CLOUD RIFLE";

#define weapon_sprt
with(self) if (instance_exists(Player)) && ("wep" in self) && ((wep = "thunder cloud rifle") || (bwep = "thunder cloud rifle")) && ("TCRAmmo" in self) && (TCRAmmo < 9.5){
	if TCRAmmo > 8.5 return global.sprThunderCloudRifle_9;
	else if TCRAmmo > 7.5 return global.sprThunderCloudRifle_8;
	else if TCRAmmo > 6.5 return global.sprThunderCloudRifle_7;
	else if TCRAmmo > 5.5 return global.sprThunderCloudRifle_6;
	else if TCRAmmo > 4.5 return global.sprThunderCloudRifle_5;
	else if TCRAmmo > 3.5 return global.sprThunderCloudRifle_4;
	else if TCRAmmo > 2.5 return global.sprThunderCloudRifle_3;
	else if TCRAmmo > 1.5 return global.sprThunderCloudRifle_2;
	else if TCRAmmo > 0.5 return global.sprThunderCloudRifle_1;
	else return global.sprThunderCloudRifle_0;
}
else return global.sprThunderCloudRifle_X;

#define weapon_type
return 0;

#define weapon_melee
return false;

#define weapon_auto
return true;

#define weapon_load
return 10;

#define weapon_cost
return 0;

#define weapon_swap
return sndSwapMachinegun;

#define weapon_area
return 31;

#define weapon_text
return "THUNDERCLAP";

#define weapon_fire
if TCRAmmo > 0 {
	if !instance_exists(global.TCRBulletGlower) {
		global.TCRBulletGlower = instance_create(0, 0, CustomObject);
		with(global.TCRBulletGlower){
			script_bind_draw(TCRBulletGlow, 0.1);
		}
	}
	repeat(3) if(instance_exists(self)){
		with instance_create(x+lengthdir_x(2, gunangle),y+lengthdir_y(2, gunangle),CustomProjectile){
			motion_add(other.gunangle + random_range(-5,5)*other.accuracy,17.5 + 5*skill_get(13));
			image_angle = direction;

			team = other.team;
			creator = other;

			sprite_index = global.sprTCRBullet;
			mask_index = mskBullet1;
		
			damage = 6;
			force = 6;
		
			on_hit = script_ref_create(TCRHurt);
			on_wall = script_ref_create(TCRWall);

			canthurt = noone;
			hurttime = -1;
			
			time = 6;
			
			script_bind_step(TCRbullet, 0, id);
		}
		sound_play_gun(sndOasisShoot, 0.25, 0.5);
		motion_add(other.gunangle,-2)
		wkick = 15;
		
		wait(3);
	}

	TCRAmmo -= 1;
	
}
else with instance_create(x,y,PopupText){
	mytext = "EMPTY";
	time = 15;
}
wkick = 10;

#define step
with(Player) if (wep = "thunder cloud rifle") || (bwep = "thunder cloud rifle") {
	if "TCRAmmo" not in self TCRAmmo = 10 + 10*skill_get(10);
	
	if (((wep = "thunder cloud rifle") && wkick <= 0) || (wep != "thunder cloud rifle")) && (TCRAmmo < 10 + 10*skill_get(10)) {
		TCRAmmo += 0.04;
	}
}

#define TCRbullet(Me)
with(Me) {
	image_angle = direction;

	if speed > 0 speed -= speed/10;
	
	if (speed > 1) && ((image_index > 1) && (image_index < 2)) image_speed = 0;
	else image_speed = 0.5;
	
	time += 1;
	if time = 12 {
		time = 0;
		sound_play_pitchvol(sndLightningPistol, random_range(2, 4), 0.4);
		with instance_create(x+lengthdir_x(speed*3,direction),y+lengthdir_y(speed*3,direction),Lightning){
			move_contact_solid(other.direction + 180, 10);
			team = other.team;
			creator = other
			ammo = 3;
			image_angle = other.direction + 180 + (random_range(-30, 30));
			
			alarm0 = 1;
			with instance_create(x,y,LightningSpawn) image_angle = other.image_angle;
		}
	}
	
	if image_index > 3 instance_destroy();
	
	with(projectile) if instance_exists(self) && instance_exists(other) && (team != other.team) && (distance_to_object(other) < 7.5) {
		instance_destroy();
		other.speed /= (1.5 - 0.25*skill_get(13));
	}
	
	if (instance_exists(self)) && (hurttime >= 0) hurttime -= 1;
	if (instance_exists(self)) && (hurttime = 0) && (canthurt != noone) canthurt = noone;
}
if (!instance_exists(Me)) {
	instance_destroy();
}

#define TCRBulletGlow
with(CustomProjectile) if sprite_index = global.sprTCRBullet {
	draw_set_blend_mode(bm_add);
	draw_sprite_ext(sprite_index, image_index, x, y, 1.5, 1.5, direction, c_white, 0.1);
	draw_set_blend_mode(bm_normal);
}

#define TCRHurt
if canthurt != other {
	projectile_hit(other, damage, force, direction);
	canthurt = other;
	hurttime = 10;
}

#define TCRWall
speed = 0;