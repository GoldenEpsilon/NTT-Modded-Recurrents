#define init
global.sprThunderCloudMinigun_0 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAGFBMVEUAAAAAAAAiERA0IR5HLy1OYHRnRD+QpLT+OupDAAAAAXRSTlMAQObYZgAAAHpJREFUeNqtjUESwyAMAyPLUf7/40rxNBzCoYcuDMbsyBw/AWDKzpHEXfB2RRamYpfDAVPlYzMU+jJ+SQciy1g+foa11CZ/d6cR4s4rnK2sSInefcvWDcVHTnKNpfUrOdhKtUmOhQRxkwyRZMM00bksOX1ecoxZuP8fH1e7A0tbiJ5JAAAAAElFTkSuQmCC", 4, 3);
global.sprThunderCloudMinigun_1 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAGFBMVEUAAAAAAAAiERA0IR5HLy1OYHRnRD+QpLT+OupDAAAAAXRSTlMAQObYZgAAAH5JREFUeNqtkUEKxDAMAyvLUf7/45VjtqE0hz3sJESYQYbS6ycAdJwcSazA2wUZ6MSphwsmws9hKfSl/ZYulBxzDsvb97KU0oRxeBDKjVmMVJ0gQ6JvLplaULxlN/daWr+aja0Uh2ZbSBBPTVOSTJgkMp+f6rnoX9Bm4/l/fABqCANZvgpquQAAAABJRU5ErkJggg==", 4, 3);
global.sprThunderCloudMinigun_2 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAIJJREFUeNqtkcEKAzEIRHfcUfP/X9wx0oalHnroS4jIYyQh108A6DI5ktgF385IQ1dMOVwQZjqGocg38g+pQMlYKyQ/vod5pos74lZRkygXqwjPWiYyqe1bem6YLElKdvKMZR55khvUMBuSbVF35JQUJUmHcML9+VT1RX9Bm4P6//ECCjcD9ZozaUUAAAAASUVORK5CYII=", 4, 3);
global.sprThunderCloudMinigun_3 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAINJREFUeAGtkUEKw0AMAyNHtvL/F1eOacPSPfTQiUGYQYawx08AmNg5krjj2yLIwCR2PRwwEQA2R6E3i7d0oWVdV1l+/BxLKU0Zhxe1RF1Npfo7q06Jnrxl6oaiZRhpms9ZaiQZT3OwlWLk0hwLCeKuaVqSCZNE5vqr3pt5As+C9//xAhgfBAG+n4XvAAAAAElFTkSuQmCC", 4, 3);
global.sprThunderCloudMinigun_4 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAIVJREFUeAGtjNGuwzAIQ2tqcP//i68Julur5WEPO0Gx4AiOrwAwsXMkseLTIsjAJHZ7OGAi/G2OQv88vGUALeu6yvLl51hKaVo63Kgl3JtK9Ssj0ZVLphYULc+qU07X7Sy1ZJj35mArRUsy7ptjIUEc+dw0LemJSSITuMnpe9Kf64H73/EHKWEEEbNG620AAAAASUVORK5CYII=", 4, 3);
global.sprThunderCloudMinigun_5 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAIZJREFUeNqtkEEOAyEMA9dZB+//X1wHaKSqHHrogIjCyJHg+gkAq5wcScyCbxdkYFWccrhgInwchkJvtm/pQMnxPMOy/RqWUpqSmdUI5dybkfLaSXrnlKkJxZJG2skeS015j3F3cmMrhWWYTraFBCfqMzrZlKRvTBKZn0+tft7UsUxT/f94ATjTBCFcxZ30AAAAAElFTkSuQmCC", 4, 3);
global.sprThunderCloudMinigun_6 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAIJJREFUeNqtjEESwzAIAyMCKP9/cUVo8CE+9NC1xxh2xPETALrsnLvjLng7czd0xS6HA8JMz2Yp+NB+SQVK5nWl5PheFmSIkhHVEOXUiwzWSUG6btwyeOM68V3bybXWpV/JRpY0yTPznORYkFDCxCSHkq6JCEfUZ8nua1JPm6H6//EBQjMELYJmv5YAAAAASUVORK5CYII=", 4, 3);
global.sprThunderCloudMinigun_7 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAHlBMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLT///92cBK8AAAAAXRSTlMAQObYZgAAAIFJREFUeAGtkMEOgzAMxXBJ+vj/L95Ly9C2ctgBgxQiyzmw/QUwx52LCMZYLS2iMSd3HRumNWCRdnpj/yUdlOzH0S0vP4+llKakhxeVxLvpKT9nGX5zyNQgFCWNdJbX2bBey4Gt1NZyAhIu9t73n9KUjEhMBpnwKb0X/oLl/3t/jhdQdwRBaHaW+AAAAABJRU5ErkJggg==", 4, 3);
global.sprThunderCloudMinigun_8 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAH9JREFUeAGtkNEKgzAUQ01NGv//i5fa66DUhz3sIIRwyAV7/ASAGW+OJO7A7hrZMBNvOxwIrQHYZJwfFh+ZwZD9unrk4+uYbIUhEynGcOmhK121ZD7dUr6hOWSwv8s6y+htOYm1274sCxtmyWUZhiR19n6KkJZfnb3Y3j/9f3wAW+AEV+Vd3tMAAAAASUVORK5CYII=", 4, 3);
global.sprThunderCloudMinigun_9 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAIJJREFUeNqlkFEKAyEMRB13xuz9T9yJoSutfhT6FEN4TFDbTwCocnIkMQt218mOqjjl0GB693EYinhTfkkHUo77HpaPr2GKkEkpZRNI594MRa5K0ltTKiYMpjQRlVxjab0lC9uIfkiWRd6RKb+SSUpSKUVIH0+tHtcYF7D9/3p0+58XZVYEb8kOWBMAAAAASUVORK5CYII=", 4, 3);
global.sprThunderCloudMinigun_X = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAAG1BMVEUAAAAAAAAiERAtOk40IR5HLy1OYHRnRD+QpLRcPifCAAAAAXRSTlMAQObYZgAAAIVJREFUeAGN0dFuhTAMg+H9xal5/ydeTYa2ATrCXETRJ+eCfr0K0OPJJHGMuzKkQU+eeuQ0YwAPR/EZ4B8OCM59nwtP/zlWdq0Eq7KY2NyTWc7XTdkqguUjsoIrdjd/zyp8bXaW2uPe7ICNFbw0k6BUwRJV8Ad7JwjX/98725wbH14u9iLfbJ8EiXSxTBoAAAAASUVORK5CYII=", 4, 3);

global.sprTCMBullet = sprite_add_base64("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAMAAACROYkbAAAAElBMVEUAAAByn78rOU9PY3mYrr////91wG3ZAAAAAnRSTlMAAHaTzTgAAAB0SURBVHjapZNJDsAgDAPtwP/f3ASaWtwqPOJChEdhQ8GxIO6o+ExuFaz45s5QeRmQRIwmsAhEjm+uWsLKy8CKy/kmCJag510johtQCzuvghZzGU4BUzAPxplXgBKIXwIhgbAF9hbsQ7Sv0X1I/lP2P5P9nR9gHAXx4iI11QAAAABJRU5ErkJggg==",4,8,8);

global.TCMBulletGlower = noone;

#define weapon_name
return "THUNDER CLOUD MINIGUN";

#define weapon_sprt
with(self) if (instance_exists(Player)) && ("wep" in self) && ((wep = "thunder cloud minigun") || (bwep = "thunder cloud minigun")) && ("TCMAmmo" in self) && (TCMAmmo < 9.5){
	if TCMAmmo > 8.5 return global.sprThunderCloudMinigun_9;
	else if TCMAmmo > 7.5 return global.sprThunderCloudMinigun_8;
	else if TCMAmmo > 6.5 return global.sprThunderCloudMinigun_7;
	else if TCMAmmo > 5.5 return global.sprThunderCloudMinigun_6;
	else if TCMAmmo > 4.5 return global.sprThunderCloudMinigun_5;
	else if TCMAmmo > 3.5 return global.sprThunderCloudMinigun_4;
	else if TCMAmmo > 2.5 return global.sprThunderCloudMinigun_3;
	else if TCMAmmo > 1.5 return global.sprThunderCloudMinigun_2;
	else if TCMAmmo > 0.5 return global.sprThunderCloudMinigun_1;
	else return global.sprThunderCloudMinigun_0;
}
else return global.sprThunderCloudMinigun_X;

#define weapon_type
return 0;

#define weapon_melee
return false;

#define weapon_auto
return true;

#define weapon_load
return 20;

#define weapon_cost
return 0;

#define weapon_swap
return sndSwapMachinegun;

#define weapon_area
return 35;

#define weapon_text
return "NOCTILUCENT";

#define weapon_fire
if TCMAmmo >= 10 {
	canswap = 0;
	if !instance_exists(global.TCMBulletGlower) {
		global.TCMBulletGlower = instance_create(0, 0, CustomObject);
		with(global.TCMBulletGlower){
			script_bind_draw(TCMBulletGlow, 0.1);
		}
	}
	repeat(40) if(instance_exists(self)){
		with instance_create(x+lengthdir_x(1, gunangle),y+lengthdir_y(1, gunangle) + 6,CustomProjectile){
			motion_add(other.gunangle + random_range(-10,10)*other.accuracy,15 + 5*skill_get(13));
			image_angle = direction;

			team = other.team;
			creator = other;

			sprite_index = global.sprTCMBullet;
			mask_index = mskBullet1;
		
			damage = 2;
			force = 2;
		
			on_hit = script_ref_create(TCMHurt);
			on_wall = script_ref_create(TCMWall);

			canthurt = noone;
			hurttime = -1;
			
			time = 7;
			
			script_bind_step(TCMbullet, 0, id);
		}
		sound_play_gun(sndOasisShoot, 0.25, 0.5);
		motion_add(other.gunangle,-2)
		wkick = 15;
		
		TCMAmmo -= 0.25;
		wait(2);
	}
	canswap = 1;
}
else with instance_create(x,y,PopupText){
	mytext = "EMPTY";
	time = 15;
	
}
wkick = 10;

#define step
with(Player) if (wep = "thunder cloud minigun") || (bwep = "thunder cloud minigun") {
	if "TCMAmmo" not in self TCMAmmo = 10 + 10*skill_get(10);
	
	if (((wep = "thunder cloud minigun") && wkick <= 0) || (wep != "thunder cloud minigun")) && (TCMAmmo < 10 + 10*skill_get(10)) {
		TCMAmmo += 0.04;
	}
}

#define TCMbullet(Me)
with(Me) {
	image_angle = direction;

	if speed > 0 speed -= speed/10;
	
	if (speed > 1) && ((image_index > 1) && (image_index < 2)) image_speed = 0;
	else image_speed = 0.5;
	
	time += 1;
	if time = 14 {
		time = 0;
		sound_play_pitchvol(sndLightningPistol, random_range(2, 4), 0.4);
		with instance_create(x+lengthdir_x(speed*3,direction),y+lengthdir_y(speed*3,direction),Lightning){
			move_contact_solid(other.direction + 180, 10);
			team = other.team;
			creator = other
			ammo = 3;
			image_angle = other.direction + 180 + (random_range(-30, 30));
			
			alarm0 = 1;
			with instance_create(x,y,LightningSpawn) image_angle = other.image_angle;
		}
	}
	
	if image_index > 3 instance_destroy();
	
	with(projectile) if instance_exists(self) && instance_exists(other) && (team != other.team) && (distance_to_object(other) < 7.5) {
		instance_destroy();
		other.speed /= (1.5 - 0.25*skill_get(13));
	}
	
	if (instance_exists(self)) && (hurttime >= 0) hurttime -= 1;
	if (instance_exists(self)) && (hurttime = 0) && (canthurt != noone) canthurt = noone;
}
if (!instance_exists(Me)) {
	instance_destroy();
}

#define TCMBulletGlow
with(CustomProjectile) if sprite_index = global.sprTCMBullet {
	draw_set_blend_mode(bm_add);
	draw_sprite_ext(sprite_index, image_index, x, y, 1.5, 1.5, direction, c_white, 0.1);
	draw_set_blend_mode(bm_normal);
}

#define TCMHurt
if canthurt != other {
	projectile_hit(other, damage, force, direction);
	canthurt = other;
	hurttime = 10;
}

#define TCMWall
speed = 0;