#define init
global.sprCloudRifle_0 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAHlBMVEUAAACfw93g7vgAAAAyJxpUQix/ZEOfw92vj2rg7vgMmPMjAAAAA3RSTlMAAAD6dsTeAAAAUklEQVR42q3OywrAIAxEUe0k4/T/f7iJgg8oXfWszEVIyhdsVmz31DCrFgJZEpMF0tWru5lLlMVLco6aedWxDhbQ/wQ6tqOYrQ/nweU/9arv9QEGeAKkNwuFxwAAAABJRU5ErkJggg==", 3, 3);
global.sprCloudRifle_1 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAHlBMVEUAAACfw93g7vgAAAAyJxpUQix/ZEOfw92vj2rg7vgMmPMjAAAAA3RSTlMAAAD6dsTeAAAAU0lEQVR42q2OSwrAMAgFk+p72vtfuGogHyhddTbiMKDtC9lY0u6JybS+YNWSMLEISXhZQBXRuAbu4LCpywIxxznJRKoJCNmeYrpazofbf/Srv9sHEe8Csi/6K3sAAAAASUVORK5CYII=", 3, 3);
global.sprCloudRifle_2 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAJFBMVEUAAACfw93g7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///84aMTlAAAAA3RSTlMAAAD6dsTeAAAAVklEQVR42q3OQQrAIAxEUe0knaT3P3AdBbVQuurfSB4BU77C1sK4ZoGpuSIgUVTRFknPru5mnsk8I85M51Cx1Ezv+A4a0HdadGxHUdaH58Hlv+pR3/UGRbEC8/8EZ5kAAAAASUVORK5CYII=", 3, 3);
global.sprCloudRifle_3 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAJFBMVEUAAACfw93g7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///84aMTlAAAAA3RSTlMAAAD6dsTeAAAAVUlEQVR42q3OywrAIAxEUW2Mk+n/f3CTCD6gdNWz8zJgyhfZrGj3ZDIrF+RaAoL5EFBmVW1NSdAcqRg1ctRu1snxnTQnuXFQ2Y5CtHycB5f/1Ku+1wdQMQMDj88ooAAAAABJRU5ErkJggg==", 3, 3);
global.sprCloudRifle_4 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAJFBMVEUAAACfw93g7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///84aMTlAAAAA3RSTlMAAAD6dsTeAAAAU0lEQVR42q3OQQ7AIAhE0VrAYXr/Axc0ERemq76dP5PI9UU2Ff1ZXFZlwVhLQvIYAsZRzVSNBLOShlkzjxrI+Z1okNx09w6T7SigDivx+k+727m+YSwDIfA8xGUAAAAASUVORK5CYII=", 3, 3);
global.sprCloudRifle_5 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAJFBMVEUAAACfw93g7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///84aMTlAAAAA3RSTlMAAAD6dsTeAAAAVUlEQVR4Aa3OQQ6AIAxEUXAo0/H+B7aIAibGlX/5KGnTV1ia6PvIMVQzAvdntjwGSdOpZqWYRDWVjJcGT+3rUCK0GY9oWI4igepegefB/T39Ud7yux5x1gNFZZ5+mAAAAABJRU5ErkJggg==", 3, 3);
global.sprCloudRifle_6 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAJFBMVEUAAACfw93g7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///84aMTlAAAAA3RSTlMAAAD6dsTeAAAAWklEQVR4AZXPQQ6AIBBDUbAMnXr/AzuAARbExLfzpxFIX7BZ0e/JMasW9jUaNh5D0tSrWSkmUa1KxrdG7jVI4ziUAMnGHwzbpUjAQyw38YXqXnF8SvonX/lcH38hA2uF44DfAAAAAElFTkSuQmCC", 3, 3);
global.sprCloudRifle_7 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAJFBMVEUAAACfw93g7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///84aMTlAAAAA3RSTlMAAAD6dsTeAAAAW0lEQVR42n3PMQ7AIAxDUagJTnr/A9epEDDQ/o0nD6H8ha2Ffs8cU2NFICVj5hqSFq+atWbaRGqEcah4KYTSppAbVzRsR5FAbrXc0guuBq7Q3TuOHyxf1aue9QGLsgOVOmHAJQAAAABJRU5ErkJggg==", 3, 3);
global.sprCloudRifle_8 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABUAAAAOCAMAAAD32Kf8AAAAJFBMVEUAAACfw93g7vgAAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///84aMTlAAAAA3RSTlMAAAD6dsTeAAAAXUlEQVR42n3PQQ6AIAxEUXEo03r/A9uxiXWh/h0vkwDbX3jU6Med49boCEgUleeQtLjUbE7LTUgjjKXi1roOM4M2ntHweBQJaKtllydoW9h96XJfePu2cOyjrSo9AZLNA7sAfHcwAAAAAElFTkSuQmCC", 3, 3);

global.sprCRBullet = sprite_add_base64("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAMAAACROYkbAAAAD1BMVEUAAAByn79yn7+fw93////aoC5MAAAAAnRSTlMAAHaTzTgAAAB0SURBVHjapZNJDsAgDAPtwP/f3ASaWtwqPOJChEdhQ8GxIO6o+ExuFaz45s5QeRmQRIwmsAhEjm+uWsLKy8CKy/kmCJag510johtQCzuvghZzGU4BUzAPxplXgBKIXwIhgbAF9hbsQ7Sv0X1I/lP2P5P9nR9gHAXx4iI11QAAAABJRU5ErkJggg==",4,8,8);

global.CRBulletGlower = noone;

#define weapon_name
return "CLOUD RIFLE";

#define weapon_sprt
with(self) if (instance_exists(Player)) && ("wep" in self) && ((wep = "cloud rifle") || (bwep = "cloud rifle")) && ("CRAmmo" in self) && (CRAmmo < 7.5){
	if CRAmmo > 6.5 return global.sprCloudRifle_7;
	else if CRAmmo > 5.5 return global.sprCloudRifle_6;
	else if CRAmmo > 4.5 return global.sprCloudRifle_5;
	else if CRAmmo > 3.5 return global.sprCloudRifle_4;
	else if CRAmmo > 2.5 return global.sprCloudRifle_3;
	else if CRAmmo > 1.5 return global.sprCloudRifle_2;
	else if CRAmmo > 0.5 return global.sprCloudRifle_1;
	else return global.sprCloudRifle_0;
}
else return global.sprCloudRifle_8;

#define weapon_type
return 0;

#define weapon_melee
return false;

#define weapon_auto
return true;

#define weapon_load
return 10;

#define weapon_cost
return 0;

#define weapon_swap
return sndSwapMachinegun;

#define weapon_area
if GameCont.hard < 31 {
	return 15;
}
return -1;

#define weapon_text
return "RAPID BREATHING";

#define weapon_fire
if CRAmmo > 0 {
	if !instance_exists(global.CRBulletGlower) {
		global.CRBulletGlower = instance_create(0, 0, CustomObject);
		with(global.CRBulletGlower){
			script_bind_draw(CRBulletGlow, 0.1);
		}
	}
	repeat(3) if(instance_exists(self)){
		with instance_create(x+lengthdir_x(2, gunangle),y+lengthdir_y(2, gunangle),CustomProjectile){
			motion_add(other.gunangle + random_range(-5,5)*other.accuracy,17.5 + 5*skill_get(13));
			image_angle = direction;

			team = other.team;
			creator = other;

			sprite_index = global.sprCRBullet;
			mask_index = mskBullet1;
		
			damage = 6;
			force = 6;
		
			on_hit = script_ref_create(CRHurt);
			on_wall = script_ref_create(CRWall);

			canthurt = noone;
			hurttime = -1;
			
			script_bind_step(CRbullet, 0, id);
		}
		sound_play_gun(sndOasisShoot, 0.25, 0.5);
		motion_add(other.gunangle,-2)
		wkick = 15;
		
		wait(3);
	}

	CRAmmo -= 1;
	
}
else with instance_create(x,y,PopupText){
	mytext = "EMPTY";
	time = 15;
}
wkick = 10;

#define step
with(Player) if (wep = "cloud rifle") || (bwep = "cloud rifle") {
	if "CRAmmo" not in self CRAmmo = 8 + 8*skill_get(10);
	
	if (((wep = "cloud rifle") && wkick <= 0) || (wep != "cloud rifle")) && (CRAmmo < 8 + 8*skill_get(10)) {
		CRAmmo += 0.03;
	}
}

#define CRbullet(Me)
with(Me) {
	image_angle = direction;

	if speed > 0 speed -= speed/10;
	
	if (speed > 1) && ((image_index > 1) && (image_index < 2)) image_speed = 0;
	else image_speed = 0.5;
	
	if image_index > 3 instance_destroy();
	
	with(projectile) if instance_exists(self) && instance_exists(other) && (team != other.team) && (distance_to_object(other) < 7.5) {
		instance_destroy();
		other.speed /= (1.5 - 0.25*skill_get(13));
	}
	
	if (instance_exists(self)) && (hurttime >= 0) hurttime -= 1;
	if (instance_exists(self)) && (hurttime = 0) && (canthurt != noone) canthurt = noone;
}
if (!instance_exists(Me)) {
	instance_destroy();
}

#define CRBulletGlow
with(CustomProjectile) if sprite_index = global.sprCRBullet {
	draw_set_blend_mode(bm_add);
	draw_sprite_ext(sprite_index, image_index, x, y, 1.5, 1.5, direction, c_white, 0.1);
	draw_set_blend_mode(bm_normal);
}

#define CRHurt
if canthurt != other {
	projectile_hit(other, damage, force, direction);
	canthurt = other;
	hurttime = 10;
}

#define CRWall
speed = 0;