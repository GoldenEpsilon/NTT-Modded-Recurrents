#define init
global.sprCloudCannon_0 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABsAAAAOCAMAAADpEZdPAAAAHlBMVEUAAAB/ZEOfw90AAAAyJxpUQix/ZEOfw92vj2rg7vgly6VqAAAAA3RSTlMAAAD6dsTeAAAAaklEQVQYGQXBgQHAMAgDILT+f/E0AwAAACgeAACwxpsGAICzQwJwDeCaYbcKQePDCDW8Pg2Xg5LjGFw7iMahLcbSDgDgyLCPaEltkXCxDByNSmC9tSh4VCUWACjgFVnaAVDAwwIAAAAAwA8iVjMFdLf97QAAAABJRU5ErkJggg==", 6, 5);
global.sprCloudCannon_1 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABsAAAAOCAMAAADpEZdPAAAAHlBMVEUAAAB/ZEOfw90AAAAyJxpUQix/ZEOfw92vj2rg7vgly6VqAAAAA3RSTlMAAAD6dsTeAAAAbElEQVR42pXOQQ6AIAxEUXRoqfe/sJ8hxg0x8a0afqpt37TnNK6dodmyHkzv6Cb1QEdhsFMVpcN7uRYyEh3J6EahIqLAR9h3I4qH5W0+FJojL+rzo0IGxcSDj5H5vFWeUyltS/xspvPcNLQ/bp68BOqMyvyqAAAAAElFTkSuQmCC", 6, 5);
global.sprCloudCannon_2 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABsAAAAOCAMAAADpEZdPAAAAIVBMVEUAAAB/ZEOfw90AAAAyJxpUQixyn79/ZEOfw92vj2rg7vhSxfjbAAAAA3RSTlMAAAD6dsTeAAAAb0lEQVR42pWPQQ7AIAgErUiB/v/B3V3DzTTpHHTDBMTxjZ2RyudEGl1Uo9RRzmw5WKBAoqfKyy71xW4ID3Bn3oEoRxPEvcDup9NQFoScO24tSsmIii0ONRBOI4eClumP8RC9Ksw4YniMas6DA+MPLxImBV7bgP5UAAAAAElFTkSuQmCC", 6, 5);
global.sprCloudCannon_3 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABsAAAAOCAMAAADpEZdPAAAAIVBMVEUAAAB/ZEOfw90AAAAyJxpUQixyn79/ZEOfw92vj2rg7vhSxfjbAAAAA3RSTlMAAAD6dsTeAAAAcUlEQVR4AZXPQY4DIQxEUaYLt11z/wPnY8QORcrbxMqXhXt8p7tO9X9TWi199HTGbtIMTBjFjh3WX+/lXshIFJJxN0ouEcZb9drdiLLnZuzfPhRaIw/yLttCRheIP/qY82F7CedUyrgSj6z0PJeG8YsPHf0FbMlgURYAAAAASUVORK5CYII=", 6, 5);
global.sprCloudCannon_4 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABsAAAAOCAMAAADpEZdPAAAAJFBMVEUAAAB/ZEOfw90AAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9JSHgJAAAAA3RSTlMAAAD6dsTeAAAAb0lEQVR42pXOQQrEMAxD0bSKa2vuf+DKCtmFwryV4ePE4xvOnOp3UuiW3Dzt0Q2YIVMopR0yiMt7uRYyUrqlRrcu2SK8J6SbIsi5UJ6qh/Shgh71IWY/CslYxa/Cx8B83ir7VJVxBH3W6b4PTcY/Xi0XBYDlMhNbAAAAAElFTkSuQmCC", 6, 5);
global.sprCloudCannon_5 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABsAAAAOCAMAAADpEZdPAAAAJFBMVEUAAAB/ZEOfw90AAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9JSHgJAAAAA3RSTlMAAAD6dsTeAAAAbUlEQVR42pWOQQrEMAwDs1VcW/v/B6/kUHIJhZ2TYJDs8Q7OtKrviYJd8kFpx3bADDEFRalDBvHpXq5CRgq7VGxnkyZi9+x6lJyLdoL0owaOOojp0bvqzlimV9HPYLPM86rMOAIds7qugxPjH34/JgWeYVG31AAAAABJRU5ErkJggg==", 6, 5);
global.sprCloudCannon_6 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABsAAAAOCAMAAADpEZdPAAAAJFBMVEUAAAB/ZEOfw90AAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9JSHgJAAAAA3RSTlMAAAD6dsTeAAAAc0lEQVR42pWQUQqEQAxDXTO1jfc/8KbRQRaGBd9XnEfa4vYfrLGqc0WhXXLiNKMdMEIMQVHqkEF83MurkJGiXSratckmwj1B2kmCHOJnpg8V6KiF2tszRcZlPBU+Bs1RdeBW81SZ+eHwWC3rl31f/7ftDV9M5gW+MLVsfAAAAABJRU5ErkJggg==", 6, 5);
global.sprCloudCannon_7 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABsAAAAOCAMAAADpEZdPAAAAJFBMVEUAAAB/ZEOfw90AAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9JSHgJAAAAA3RSTlMAAAD6dsTeAAAAc0lEQVR42pWOWwrDQAwD23gdW73/gSvJhCUQCp0v4fHr9Zt4xqo/T3TIFS6YdrSLWEkWAWnOAIl4e65qerOIXDHayZTI3HNyXgqswY4AflRSkQd599qZY7w1/EyIJh4y8yqN89l9Km3LYyochxpvagr/8AVcgwXo1Ef4SQAAAABJRU5ErkJggg==", 6, 5);
global.sprCloudCannon_8 = sprite_add_weapon("iVBORw0KGgoAAAANSUhEUgAAABsAAAAOCAMAAADpEZdPAAAAJFBMVEUAAAB/ZEOfw90AAAAyJxpUQixyn79/ZEOfw92vj2rg7vj///9JSHgJAAAAA3RSTlMAAAD6dsTeAAAAc0lEQVR42oWO0Q6EQAgDT1mE+v8ffC24UROj89QwKfB7x54plfsTaXKBSeASrVcOJ4OAJDuAw5bqRRfCg8gFYzmZEO5nT66WAqMpR4B6VFKRB3l37vQ2tdXqGRNJ7FDz1dGDckqn5TEN1tW2zO3uyDV+8gdlNgYODLUDVgAAAABJRU5ErkJggg==", 6, 5);

global.sprCCBigBullet = sprite_add_base64("iVBORw0KGgoAAAANSUhEUgAAAGAAAAAYCAMAAAAyNwimAAAADFBMVEUAAAByn7+fw93///9dJDQaAAAAAXRSTlMAQObYZgAAAMdJREFUeAG1llGKgDAMBTvj/e+8EFyTNSylQvKl72OGtDZ1PWXUGir1ihpyeJV6GVClBJt8AXT+fwa8Mxo+4pbnQ+d3A5aQpm0Kuqvzi4G/KWuV3Kg0JxLqa+enwQoqjRkpgJp5q52Amx+c0gJlYdCnBd57wEZgLjFhMBugbocnDaSB5P8auJEWZLZwKjAEyYk0G2gt0OHsBRTOXsCLPi+YX6L5TZ78TL8fNE8O2vyo+DLsPBl238a1B+N6/sKZvzLnL/3B35YfGQEJiANK+5IAAAAASUVORK5CYII=",4,12,12);
global.sprCCBullet = sprite_add_base64("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAMAAACROYkbAAAAFVBMVEUAAAByn7+fw93///9yn7+fw93///89T4TsAAAABHRSTlMAAAAAs5NmmgAAAIJJREFUeNrdk0sOgCAMRBkYvP+RnfJxFqxId75oTMf2hSiUgH3AUQAU3ZFgoS7XAUHiG3/EfK9Y5cYTIXBti273y7B0NhQsKobBw0oAPaPfhkOAKlpwCJRVlEhNJ3kK2mQLNpHXtQAvAbeC3e0B3gjwA0H6I6Z/Y3Yjpbdy/jClj/MLKLcNp/ErVaUAAAAASUVORK5CYII=",4,8,8);

global.CCBulletGlower = noone;

#define weapon_name
return "CLOUD CANNON";

#define weapon_sprt
with(self) if (instance_exists(Player)) && ("wep" in self) && ((wep = "cloud cannon") || (bwep = "cloud cannon")) && ("CCAmmo" in self) && (CCAmmo < 7.5){
	if CCAmmo > 6.5 return global.sprCloudCannon_7;
	else if CCAmmo > 5.5 return global.sprCloudCannon_6;
	else if CCAmmo > 4.5 return global.sprCloudCannon_5;
	else if CCAmmo > 3.5 return global.sprCloudCannon_4;
	else if CCAmmo > 2.5 return global.sprCloudCannon_3;
	else if CCAmmo > 1.5 return global.sprCloudCannon_2;
	else if CCAmmo > 0.5 return global.sprCloudCannon_1;
	else return global.sprCloudCannon_0;
}
else return global.sprCloudCannon_8;

#define weapon_type
return 0;

#define weapon_melee
return false;

#define weapon_auto
return true;

#define weapon_load
return 15;

#define weapon_cost
return 0;

#define weapon_swap
return sndSwapMachinegun;

#define weapon_area
if GameCont.hard < 33 {
	return 17;
}
return -1;

#define weapon_text
return "PUFF TRICKS";

#define weapon_fire
if CCAmmo >= 4 {
	if !instance_exists(global.CCBulletGlower) {
		global.CCBulletGlower = instance_create(0, 0, CustomObject);
		with(global.CCBulletGlower){
			script_bind_draw(CCBulletGlow, 0.1);
		}
	}
	with instance_create(x+lengthdir_x(2, gunangle),y+lengthdir_y(2, gunangle),CustomProjectile){
		motion_add(other.gunangle + random_range(-5,5)*other.accuracy,12 + 2*skill_get(13));
		image_angle = direction;

		team = other.team;
		creator = other;

		sprite_index = global.sprCCBigBullet;
		mask_index = mskBullet1;
		
		damage = 10;
		force = 4;
		
		on_hit = script_ref_create(CCHurt);
		on_wall = script_ref_create(CCWall);
		on_destroy = script_ref_create(CCPop);
		
		image_xscale = 1.25;
		image_yscale = 1.25;
		
		canthurt = noone;
		hurttime = -1;
		
		script_bind_step(CCBbullet, 0, id);
	}
	sound_play_gun(sndOasisShoot, 0.25, 0.5);
	motion_add(other.gunangle,-2)
	wkick = 17;

	CCAmmo -= 4;
	
}
else with instance_create(x,y,PopupText){
	mytext = "EMPTY";
	time = 15;
}
wkick = 16;

#define step
with(Player) if (wep = "cloud cannon") || (bwep = "cloud cannon") {
	if "CCAmmo" not in self CCAmmo = 8 + 8*skill_get(10);
	
	if (((wep = "cloud cannon") && wkick <= 0) || (wep != "cloud cannon")) && (CCAmmo < 8 + 8*skill_get(10)) {
		CCAmmo += 0.03;
	}
}

#define CCBbullet(Me)
with(Me) {
	image_angle += 10;

	if speed > 0 speed -= speed/10;
	
	if (speed > 1) && ((image_index > 1) && (image_index < 2)) image_speed = 0;
	else image_speed = 0.5;
	
	if image_index > 3 instance_destroy();
	
	with(projectile) if instance_exists(self) && instance_exists(other) && (team != other.team) && (distance_to_object(other) < 20) {
		instance_destroy();
	}
	
	if (instance_exists(self)) && (hurttime >= 0) hurttime -= 1;
	if (instance_exists(self)) && (hurttime = 0) && (canthurt != noone) canthurt = noone;
	
}
if (!instance_exists(Me)) {
	instance_destroy();
}

#define CCSbullet(Me)
with(Me) {
	image_angle = direction;

	if speed > 0 speed -= speed/10;
	
	if (speed > 1) && ((image_index > 1) && (image_index < 2)) image_speed = 0;
	else image_speed = 0.5;
	
	if image_index > 3 instance_destroy();
	
	with(projectile) if instance_exists(self) && instance_exists(other) && (team != other.team) && (distance_to_object(other) < 15) {
		instance_destroy();
		other.speed /= (1.1 - 0.05*skill_get(13));
	}
	
	if (instance_exists(self)) && (hurttime >= 0) hurttime -= 1;
	if (instance_exists(self)) && (hurttime = 0) && (canthurt != noone) canthurt = noone;
}
if (!instance_exists(Me)) {
	instance_destroy();
}

#define CCPop
var a = random(360);
repeat(16){
	a += 22.5;
	with instance_create(x+lengthdir_x(2, a),y+lengthdir_y(2, a),CustomProjectile){
		motion_add(a + random_range(-5,5),10 + 2.5*skill_get(13));
		image_angle = direction;

		team = other.team;
		creator = other;

		sprite_index = global.sprCCBullet;
		mask_index = mskBullet1;
		
		damage = 4;
		force = 4;
		
		on_hit = script_ref_create(CCHurt);
		on_wall = script_ref_create(CCWall);
		
		canthurt = noone;
		hurttime = -1;
		
		script_bind_step(CCSbullet, 0, id);
	}
}
sound_play_gun(sndOasisShoot, 0.25, 0.3);

#define CCBulletGlow
with(CustomProjectile) if (sprite_index = global.sprCCBullet) || (sprite_index = global.sprCCBigBullet) {
	draw_set_blend_mode(bm_add);
	draw_sprite_ext(sprite_index, image_index, x, y, 1.5, 1.5, direction, c_white, 0.1);
	draw_set_blend_mode(bm_normal);
}

#define CCHurt
if canthurt != other {
	projectile_hit(other, damage, force, direction);
	canthurt = other;
	hurttime = 10;
}

#define CCWall
speed = 0;